import json
import boto3
from boto3.dynamodb.conditions import Attr

# Initialize DynamoDB resource
dynamodb = boto3.resource('dynamodb')
table = dynamodb.Table('CustomerStocks')

# Scan the table
response = table.scan(
    FilterExpression=Attr('StockValue1').gt(321)
)

# Extract and print CustomerID from the matching items
for item in response['Items']:
    print(item['CustomerID'])


def lambda_handler(event, context):
    return {
        'statusCode': 200,
        'body': json.dumps('Data fetched successfully')
    }
